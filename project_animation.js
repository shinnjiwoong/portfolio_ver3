let mindcraft = {
    "name" : "MINDCRAFT",
    "project_num" : "001",
    "year" : "2019",
    "scope" : ["music"],
    "represent_source" : ["assets/project_source/mindcraft_1.png", "assets/project_source/mindcraft_2.png"],
    "link" : "https://soundcloud.com/montikayoti/sets/mindcraft",
    "description_kr" : "MINDCRAFT는 혼란스러운 시기에서 마음을 재정비하며 제작한 6곡의 트랙을 담은 앨범이다. 얼떨결에 프로듀서로서 제대로 된 시작을 알린 작업이 되었다.  ",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let datura = {
    "name" : "DATURA : TESTTAPE",
    "project_num" : "002",
    "year" : "2019",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/Datura.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let postcorona = {
    "name" : "POSTCORONA",
    "project_num" : "003",
    "year" : "2020",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/POSTCORONA.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let rem = {
    "name" : "REM",
    "project_num" : "004",
    "year" : "2021",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/REM.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let artificial_object = {
    "name" : "DIGITS / ARTIFICIAL OBJECT",
    "project_num" : "005",
    "year" : "2021",
    "scope" : ["music"],
    "represent_source" : ["assets/project_source/ao_2.png", "assets/project_source/ao_1.png"],
    "link" : "",
    "description_kr" : "ARTIFICIAL OBJECT는 JGP$의 첫 정규앨범입니다. 전곡을 프로듀싱하였습니다. ",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let altgal_simple = {
    "name" : "＜간결한 생각들: 생태-젠더-공산＞",
    "project_num" : "006",
    "year" : "2021",
    "scope" : ["music"],
    "represent_source" : ["assets/project_source/simple_thought_1.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let kasina_kaffe = {
    "name" : "KASINA Kaffe commercial",
    "project_num" : "007",
    "year" : "2022",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/Kasina_Kaffe.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let umm_1 = {
    "name" : "꽃내음 vol.1 | UMM vol.1",
    "project_num" : "008",
    "year" : "2022",
    "scope" : ["music", "design"],
    "represent_source" : ["assets/projects/꽃내음.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let kasina_seongsu = {
    "name" : "KASINA seongsu ave. commercial",
    "project_num" : "009",
    "year" : "2022",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/꽃내음.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let onerm = {
    "name" : "ONERM : NEVER FALL DOWN",
    "project_num" : "010",
    "year" : "2022",
    "scope" : ["music"],
    "represent_source" : ["assets/project_source/onerm_2.png", "assets/project_source/onerm_3.png"],
    "link" : "",
    "description_kr" : "ARTIFICIAL OBJECT는 JGP$의 첫 정규앨범입니다. 전곡을 프로듀싱하였습니다. ",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let hyndai_casper = {
    "name" : "HYUNDAI CASPER x KASINA commercial",
    "project_num" : "011",
    "year" : "2022",
    "scope" : ["music"],
    "represent_source" : ["assets/projects/CASPER_KASINA.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}
let reservoir_dogs = {
    "name" : "RESERVOIR DOGS mix",
    "project_num" : "012",
    "year" : "2022",
    "scope" : ["mixset", "design"],
    "represent_source" : ["assets/projects/RESERVOIR_DOGS.png"],
    "link" : "",
    "description_kr" : "대안공간 루프 갤러리의 2021년 전시 ＜SIMPLE THOUGHTS: ECOLOGY-GENDER-COMMUNISM | 간결한 생각들: 생태-젠더-공산＞에 참여했다. 전시의 일부로써 시민들이 직접 갤러리의 근방을 걸으며 경험하는 과정.",
    "description_en" : "MINDCRAFT is an album with 6 musical pieces. "
}




// VAR
const project_page_container = document.querySelector(".project-page-container")
const left_loading_bar = document.querySelector(".left-loading-bar")
const right_loading_bar = document.querySelector(".right-loading-bar")
const project_page_number = document.querySelector('.project-page-number');
const scope_music_color = "rgb(255, 0, 0)";
const scope_programming_color = "rgb(0, 255, 255)";
const scope_mixset_color = "rgb(249, 249, 0)";
const scope_design_color = "rgb(8, 0, 255)";
// PROJECT SECTIONS
const sec_1 = document.querySelector(".sec-1");
const sec_2 = document.querySelector(".sec-2");
const sec_3 = document.querySelector(".sec-3");
const sec_4 = document.querySelector(".sec-4");
let sections = [sec_1, sec_2, sec_3, sec_4];

let project_arr = [reservoir_dogs, hyndai_casper, onerm, kasina_seongsu, umm_1, kasina_kaffe, altgal_simple, artificial_object, rem, postcorona, datura, mindcraft];
let whole_page_num = project_arr.length / 4;
let page_var = 1;


// FUNCTIONS

intro_work_btn.addEventListener("click", async ()=>{
    await setPageIndex(1);
    await setPageNum();
    setTimeout(async function(){
        for(let i = 0; i<4; i++){
            await showProject(sections[i], project_arr[i]);
        }
    }, 2000)
});
// 프로젝트 전환
async function setPageIndex(num){
    if(num < 1){
        page_var = whole_page_num;
    }else{
        page_var = num;
    }
}
async function getPageIndex(){
    return page_var
}
async function setPageNum(){
    let page = await getPageIndex();
    project_page_number.innerText = `${page} / ${whole_page_num}`
}
async function change_projects(num){
    if(num == project_arr.length - 1){
        let rest = project_arr.length % 4;
        for(let i = 0; i < rest; i++){
            await showProject(sections[i], project_arr[4*(num-1)+i])
        }
        for(let i = 0; i<4-rest ; i++){
            sections[rest + i].style.display = "none";
        }
    }
    for(let i = 0 ; i <4; i++){
        sections[i].style.display = "inline-block";
        await showProject(sections[i], project_arr[4*(num-1)+i]);
    }
}
async function getCursor(x, y){
    let default_rect = sec_1.getBoundingClientRect();
    if(x > default_rect.width){
        x = x - default_rect.width;
    }
    if(y > default_rect.height){
        y = y - default_rect.height
    }
    return [x, y]
}
async function showProject(e,p){

    const project_front_container = e.querySelector(".project-front-container")
    const project_back_container = e.querySelector(".project-back-container");
    const project_esc = project_back_container.querySelector(".project-esc-btn .project-esc")
    const project_img = e.querySelector(".project-img");
    const project_title = e.querySelector(".project-title")
    const project_desc_kr = e.querySelector(".project-desc-kr")
    const project_desc_en = e.querySelector(".project-desc-en")
    const project_link = e.querySelector(".project-link");
    const project_scope_container = e.querySelector(".project-scope-container");
    const project_arrow_l = e.querySelector('.project-front-container .project-cursor-left');
    const project_arrow_r = e.querySelector('.project-front-container .project-cursor-right')
    const img_len = p.represent_source.length;
    const project_scope_len = p.scope.length;
    const project_index = project_back_container.querySelector(".project-index-container .project-index");

    let rect = e.getBoundingClientRect();
    let i = 0;

    project_img.src = p.represent_source[i];
    project_title.innerText = p.name;
    project_index.innerText = `${p.project_num} - ${p.year}`
    project_desc_kr.innerText = p.description_kr;
    project_desc_en.innerText = p.description_en;
    project_link.href = p.link
    for(let i = 0; i < project_scope_len; i++){
        let scope_node = document.createElement('p');
        scope_node.classList.add('project-scope');
        if(p.scope[i] == "music"){
            scope_node.style.color = scope_music_color;
            // scope_node.style.border = `1px solid ${scope_music_color}`
        }else if(p.scope[i] == "programming"){
            scope_node.style.color = scope_programming_color;
            // scope_node.style.border = `1px solid ${scope_programming_color}`
        }else if(p.scope[i] == "mixset"){
            scope_node.style.color = scope_mixset_color;
            // scope_node.style.border = `1px solid ${scope_mixset_color}`
        }else if(p.scope[i] == "design"){
            scope_node.style.color = scope_design_color;
            // scope_node.style.border = `1px solid ${scope_design_color}`
        }
        scope_node.style.borderRadius = '30px'
        scope_node.style.fontWeight = "lighter";
        scope_node.innerText = p.scope[i]
        project_scope_container.appendChild(scope_node);
    }
    project_img.addEventListener("load", ()=>{
        project_front_container.style.opacity = "100%"
        project_back_container.style.opacity = "100%"
    })
    project_img.addEventListener("click", async (e)=>{
        
        let rect_width = rect.width;
        let rect_height = rect.height;
        let cursorPoint = await getCursor(e.clientX, e.clientY);

        project_front_container.style.display = "none"
        project_back_container.style.display = "block"
    })
    project_arrow_l.addEventListener('click', ()=>{
        if(i == img_len - 1){
            i = 0;
            project_img.src = p.represent_source[i];
        }else{
            i++;
            project_img.src = p.represent_source[i];
        }
    })
    project_arrow_r.addEventListener('click', ()=>{
        if(i == img_len - 1){
            i = 0;
            project_img.src = p.represent_source[i];
        }else{
            i++;
            project_img.src = p.represent_source[i];
        }
    })
    project_esc.addEventListener("click", ()=>{
        project_front_container.style.display = "inline-block"
        project_back_container.style.display = "none"
    })
}
window.addEventListener('click', async (e)=>{
    if(e.clientX<40){
        // 왼쪽으로 넘어감
        let changing_index = await getPageIndex();
        if(changing_index == 1){
            changing_index = project_arr.length/4;
        }else{
            changing_index = page_var - 1;
        }
        await setPageIndex(changing_index);
        await setPageNum()
        await change_projects(changing_index);
        
    }
    else if(window.innerWidth - e.clientX < 40){
        // 오른쪽으로 넘어감
        let changing_index = await getPageIndex();
        if(changing_index == project_arr.length/4){
            changing_index = 1;
        }else{
            changing_index = changing_index + 1;
        }
        await setPageIndex(changing_index);
        await setPageNum();
        await change_projects(changing_index);
    }
})





